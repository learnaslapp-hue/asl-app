import{b as m,d as p}from"./chunk-7YAWXMMP.js";import{Na as l,Oa as d,e as c,o as h,r as n}from"./chunk-55BITWVR.js";import{j as s}from"./chunk-LRBG2F7K.js";var u="quiz_status_v1",f="http://localhost:3000/api/quiz-status",z=(()=>{let r=class r{constructor(e,t){this.storage=e,this.http=t,this.userIdCtx=new l().set(p,!0)}defaultStatus(){return s(this,null,function*(){var t;return{user:(t=yield this.storage.getSavedProfile())!=null?t:{userId:"guest"},currentLevel:1,currentHighScore:0,completedQuiz:[],currentQuizId:null}})}load(){return s(this,null,function*(){var i;let e=yield this.storage.getItem(u);if(e)return e;try{let I=(i=yield this.storage.getSavedProfile())!=null?i:{userId:"guest"},a=yield c(this.http.get(`${f}?userId=${I.userId}`,{context:this.userIdCtx}));if(a)return yield this.storage.setItem(u,a),a}catch{}let t=yield this.defaultStatus();return yield this.saveLocal(t),t})}saveLocal(e){return s(this,null,function*(){yield this.storage.setItem(u,e)})}syncToServer(e){return s(this,null,function*(){let t=e!=null?e:yield this.load(),i={userId:t.user.userId,currentLevel:t.currentLevel,currentHighScore:t.currentHighScore,completedQuiz:t.completedQuiz,currentQuizId:t.currentQuizId};try{yield c(this.http.post(f,i,{context:this.userIdCtx}))}catch{}})}};r.\u0275fac=function(t){return new(t||r)(n(m),n(d))},r.\u0275prov=h({token:r,factory:r.\u0275fac,providedIn:"root"});let o=r;return o})();export{z as a};
