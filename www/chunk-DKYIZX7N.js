import{a as R}from"./chunk-D64WEJD2.js";import{a as j}from"./chunk-36NF3LEI.js";import"./chunk-7YAWXMMP.js";import{Ba as k,Ca as E,G as l,H as _,Ib as T,J as P,Ja as Q,Lb as B,Mb as F,O as g,R as p,Sb as D,T as M,Tb as H,Va as w,W as a,X as o,Xb as V,Y as f,Yb as $,Z as I,_ as z,aa as S,ba as h,bc as q,ca as u,cc as N,mb as L,na as s,oa as b,pa as v,qa as y,v as C,w as O}from"./chunk-55BITWVR.js";import"./chunk-MTUXJE3Z.js";import"./chunk-PLFY2CTQ.js";import"./chunk-7PW2J7O2.js";import"./chunk-QIBKRVRZ.js";import"./chunk-WWLKLYXQ.js";import"./chunk-ADUYDX2F.js";import"./chunk-4U6PRYVA.js";import"./chunk-FXFZIWDD.js";import"./chunk-CSG5OQLY.js";import"./chunk-VMHM3MLJ.js";import"./chunk-O4PCMGUI.js";import"./chunk-C5RQ2IC2.js";import"./chunk-42C7ZIID.js";import{j as x}from"./chunk-LRBG2F7K.js";function W(n,r){n&1&&(a(0,"div",20),s(1,"\u2713"),o())}function A(n,r){n&1&&(a(0,"div",21),s(1,"\u{1F510}"),o())}function G(n,r){if(n&1){let c=S();a(0,"button",15),h("click",function(){let e=C(c).$implicit,i=u().$implicit,d=u(2);return O(d.canOpen(i)&&d.openQuiz(e.id))}),g(1,W,2,0,"div",16),a(2,"div",17),s(3),o(),a(4,"div",18),s(5),o(),g(6,A,2,0,"div",19),o()}if(n&2){let c=r.$implicit,t=u().$implicit,e=u(2);M("locked",!e.canOpen(t)),l(),p("ngIf",e.status==null?null:e.status.completedQuiz.includes(c.id)),l(2),b(c.group),l(2),b(c.category),l(),p("ngIf",!e.canOpen(t))}}function J(n,r){if(n&1&&(a(0,"div",12)(1,"h2"),s(2),o(),a(3,"div",13),g(4,G,7,6,"button",14),o()()),n&2){let c=r.$implicit,t=u(2);l(2),v("LEVEL ",c,""),l(2),p("ngForOf",t.itemsByLevel.get(c))}}function K(n,r){if(n&1&&(I(0),g(1,J,5,2,"div",11),z()),n&2){let c=u();l(),p("ngForOf",c.levels)}}var ot=(()=>{let r=class r{constructor(t,e,i){this.router=t,this.data=e,this.statusSvc=i,this.levels=[],this.itemsByLevel=new Map,this.loading=!0}ngOnInit(){return x(this,null,function*(){this.levels=yield this.data.getLevels();for(let t of this.levels)this.itemsByLevel.set(t,yield this.data.getByLevel(t));this.loading=!1})}ionViewWillEnter(){this.loadStatus()}get points(){var t;return((t=this.status)==null?void 0:t.currentHighScore)||0}canOpen(t){var e;return t<=((e=this.status)==null?void 0:e.currentLevel)}startNext(){var i;let t=this.levels.filter(d=>{var m;return d<=((m=this.status)==null?void 0:m.currentLevel)}).flatMap(d=>this.itemsByLevel.get(d)||[]),e=(i=t.find(d=>{var m;return!((m=this.status)!=null&&m.completedQuiz.includes(d.id))}))!=null?i:t[0];e?this.openQuiz(e.id):this.openQuiz(1)}openQuiz(t){this.status&&(this.status.currentQuizId=t),this.statusSvc.saveLocal(this.status),this.router.navigate(["/quiz/quiz-game"],{queryParams:{id:t}})}loadStatus(){return x(this,null,function*(){this.status=yield this.statusSvc.load()})}};r.\u0275fac=function(e){return new(e||r)(_(w),_(R),_(j))},r.\u0275cmp=P({type:r,selectors:[["app-quiz"]],decls:22,vars:6,consts:[[1,"ion-no-border"],["slot","start"],["defaultHref","/"],["slot","end"],[1,"points"],[3,"fullscreen"],[1,"hero"],[1,"banner"],[1,"heading"],["expand","block","shape","round",2,"height","56px",3,"click"],[4,"ngIf"],["class","level-section",4,"ngFor","ngForOf"],[1,"level-section"],[1,"grid"],["class","card",3,"locked","click",4,"ngFor","ngForOf"],[1,"card",3,"click"],["class","badge",4,"ngIf"],[1,"title"],[1,"subtitle"],["class","lock-icon",4,"ngIf"],[1,"badge"],[1,"lock-icon"]],template:function(e,i){e&1&&(a(0,"ion-header",0)(1,"ion-toolbar")(2,"ion-buttons",1),f(3,"ion-back-button",2),o(),a(4,"ion-title"),s(5,"Quiz"),o(),a(6,"ion-buttons",3)(7,"ion-chip",4)(8,"ion-label"),s(9),o()()()()(),a(10,"ion-content",5)(11,"div",6)(12,"div",7)(13,"div",8),s(14),o(),f(15,"br"),a(16,"div",8),s(17),o(),f(18,"br"),a(19,"ion-button",9),h("click",function(){return i.startNext()}),s(20,"Continue"),o()()(),g(21,K,2,1,"ng-container",10),o()),e&2&&(l(9),y("",i.points," point",i.points===1?"":"s",""),l(),p("fullscreen",!0),l(4),v("Level ",i.status==null?null:i.status.currentLevel,""),l(3),v("High score: ",i.status==null?null:i.status.currentHighScore,""),l(4),p("ngIf",!i.loading))},dependencies:[H,V,q,N,Q,k,E,L,F,B,$,D,T],styles:[".hero[_ngcontent-%COMP%]{padding:16px}.hero[_ngcontent-%COMP%]   .banner[_ngcontent-%COMP%]{background:linear-gradient(298deg,#5e35b1,#7e57c2);color:#fff;border-radius:20px;padding:20px;box-shadow:0 8px 20px #00000026}.hero[_ngcontent-%COMP%]   .banner[_ngcontent-%COMP%]   .heading[_ngcontent-%COMP%]{font-size:20px;font-weight:700}.hero[_ngcontent-%COMP%]   .banner[_ngcontent-%COMP%]   .sub[_ngcontent-%COMP%]{opacity:.9;margin:8px 0 12px}.level-section[_ngcontent-%COMP%]{padding:10px 16px 0}.level-section[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:18px 0 10px;font-weight:800;letter-spacing:.5px}.grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(2,minmax(0,1fr));gap:12px 12px}.card[_ngcontent-%COMP%]{position:relative;border:none;text-align:left;color:#fff;border-radius:18px;padding:16px;height:120px;box-shadow:0 6px 14px #0000002e;background:linear-gradient(298deg,#4854e0,#6370ff)}.card[_ngcontent-%COMP%]   .lock-icon[_ngcontent-%COMP%]{position:absolute;top:20px;right:20px}.card[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{font-weight:700;font-size:15px}.card[_ngcontent-%COMP%]   .subtitle[_ngcontent-%COMP%]{opacity:.8;margin-top:6px;font-size:12px}.card.locked[_ngcontent-%COMP%]{background:#2b2b2b;background:linear-gradient(298deg,#282a3d,#5e6185);opacity:.55;pointer-events:none}.badge[_ngcontent-%COMP%]{position:absolute;top:10px;right:10px;background:#10b981;color:#052e1a;font-weight:800;padding:4px 8px;border-radius:999px;font-size:11px}.points[_ngcontent-%COMP%]{font-weight:800}"]});let n=r;return n})();export{ot as QuizPage};
