import{a as Z}from"./chunk-CKJ3JQZ6.js";import{a as tt}from"./chunk-D64WEJD2.js";import{a as Y}from"./chunk-36NF3LEI.js";import"./chunk-ZHDFZB2B.js";import"./chunk-7YAWXMMP.js";import{Ba as k,Ca as T,Da as Q,E as S,Ea as E,Fa as B,G as o,H as u,Ib as $,J as z,Ja as L,Lb as N,Mb as V,O as m,R as r,Sa as G,Sb as A,T as O,Ta as U,Tb as H,U as M,Va as F,W as p,X as c,Xb as R,Y as g,Yb as K,Z as _,_ as h,aa as w,ba as I,ca as l,cc as J,fa as q,gc as W,ic as X,mb as j,na as d,oa as v,ob as D,pa as x,s as P,v as C,w as y}from"./chunk-55BITWVR.js";import"./chunk-MTUXJE3Z.js";import"./chunk-PLFY2CTQ.js";import"./chunk-7PW2J7O2.js";import"./chunk-QIBKRVRZ.js";import"./chunk-WWLKLYXQ.js";import"./chunk-ADUYDX2F.js";import"./chunk-4U6PRYVA.js";import"./chunk-FXFZIWDD.js";import"./chunk-CSG5OQLY.js";import"./chunk-VMHM3MLJ.js";import"./chunk-O4PCMGUI.js";import"./chunk-C5RQ2IC2.js";import"./chunk-42C7ZIID.js";import{j as f}from"./chunk-LRBG2F7K.js";var b={production:!0,apiBaseUrl:"https://learnasl.vercel.app/api"};function at(t,a){if(t&1&&(p(0,"ion-buttons",6)(1,"ion-chip")(2,"ion-label"),d(3),c()()()),t&2){let e=l();o(3),x("Level ",e.status==null?null:e.status.currentLevel,"")}}function rt(t,a){if(t&1&&(p(0,"div",17),d(1),c()),t&2){let e=l().ngIf;o(),v(e.data)}}function st(t,a){if(t&1&&(p(0,"div"),g(1,"app-video-player",18),c()),t&2){let e=l().ngIf,i=l();o(),r("src",i.source+e.data)}}function ct(t,a){if(t&1&&g(0,"img",19),t&2){let e=l().ngIf;r("src",e.data,S)}}function lt(t,a){if(t&1&&(_(0),p(1,"div",22)(2,"span"),d(3),c(),g(4,"app-video-player",23),c(),h()),t&2){let e=a.$implicit,i=a.index,n=l(3);o(3),x("#",i+1,""),o(),r("src",n.source+e)}}function pt(t,a){if(t&1&&(_(0),p(1,"div",20),m(2,lt,5,2,"ng-container",21),c(),h()),t&2){let e=l().ngIf;o(2),r("ngForOf",e==null?null:e.data)}}function dt(t,a){t&1&&(p(0,"div",17),d(1,"Unsupported type"),c())}function ut(t,a){if(t&1&&g(0,"img",28),t&2){let e=l().$implicit;q("alt",e.key),r("src",e.url,S)}}function mt(t,a){if(t&1&&g(0,"app-video-player",18),t&2){let e=l().$implicit,i=l(2);r("src",i.source+e.url)}}function gt(t,a){if(t&1){let e=w();p(0,"button",24),I("click",function(){let n=C(e).$implicit,s=l(2);return y(s.pick(n))}),_(1,8),m(2,ut,1,2,"img",25)(3,mt,1,1,"app-video-player",26),h(),p(4,"div",27),d(5),c()()}if(t&2){let e=a.$implicit,i=l().ngIf,n=l();M(e.type!=="video"?"height: 56px;":""),O("selected",n.selected===e.id)("correct",n.answered&&e.id===i.correctOptionId)("incorrect",n.answered&&n.selected===e.id&&e.id!==i.correctOptionId),o(),r("ngSwitch",e.type),o(),r("ngSwitchCase","image"),o(),r("ngSwitchCase","video"),o(2),v(e.key)}}function _t(t,a){if(t&1){let e=w();p(0,"ion-content")(1,"div",7),_(2,8),m(3,rt,2,1,"div",9)(4,st,2,1,"div",10)(5,ct,1,1,"img",11)(6,pt,3,1,"ng-container",10)(7,dt,2,0,"div",12),h(),c(),p(8,"div",13),m(9,gt,6,13,"button",14),c(),p(10,"div",15)(11,"ion-button",16),I("click",function(){C(e);let n=l();return y(n.next())}),d(12),c()()()}if(t&2){let e=a.ngIf,i=l();o(2),r("ngSwitch",e.questionType),o(),r("ngSwitchCase","text"),o(),r("ngSwitchCase","single-video"),o(),r("ngSwitchCase","single-image"),o(),r("ngSwitchCase","multiple-video"),o(3),r("ngForOf",e.options)("ngForTrackBy",i.trackById),o(2),r("disabled",!i.answered),o(),x(" ",i.correct?"Great! Back to Levels":"Try Another"," ")}}var Et=(()=>{let a=class a{constructor(i,n,s,et,it,nt,ot){this.route=i,this.router=n,this.data=s,this.statusSvc=et,this.toast=it,this.alert=nt,this.platform=ot,this.answered=!1,this.correct=!1,this.source=`${b.apiBaseUrl}/`,this.san=P(G),this.init()}ngOnInit(){}init(){return f(this,null,function*(){let i=Number(this.route.snapshot.queryParamMap.get("id"));this.status=yield this.statusSvc.load();let n=yield this.data.getById(i||this.status.currentQuizId||0);if(!n){yield(yield this.alert.create({header:"Not found",message:"Quiz item missing.",buttons:["OK"]})).present(),this.router.navigateByUrl("/quiz");return}this.q=n,console.log(this.q),this.status.currentQuizId=n.id,yield this.statusSvc.saveLocal(this.status)})}getSafeSrc(i){if(i){let n=`${b.apiBaseUrl}/${i}`;return this.san.bypassSecurityTrustResourceUrl(n)}return null}trackById(i,n){return n.id}pick(i){this.answered||(this.selected=i.id,this.answered=!0,this.correct=i.id===this.q.correctOptionId,this.correct&&(this.status.completedQuiz.includes(this.q.id)||(this.status.completedQuiz.push(this.q.id),this.status.currentHighScore+=1),this.maybeLevelUp()),this.status.currentQuizId=this.q.id,this.statusSvc.saveLocal(this.status))}maybeLevelUp(){return f(this,null,function*(){(yield this.data.getByLevel(this.status.currentLevel)).every(s=>this.status.completedQuiz.includes(s.id))&&(this.status.currentLevel+=1)})}next(){return f(this,null,function*(){yield this.statusSvc.saveLocal(this.status),yield this.statusSvc.syncToServer(this.status),this.router.navigateByUrl("/quiz")})}ngOnDestroy(){this.statusSvc.saveLocal(this.status),this.statusSvc.syncToServer(this.status)}};a.\u0275fac=function(n){return new(n||a)(u(U),u(F),u(tt),u(Y),u(X),u(W),u(D))},a.\u0275cmp=z({type:a,selectors:[["app-quiz-game"]],decls:13,vars:4,consts:[[1,"ion-no-border"],["slot","start"],["defaultHref","/quiz"],["slot","end",4,"ngIf"],[2,"padding","0px 20px","font-size","rem"],[4,"ngIf"],["slot","end"],[1,"card","prompt"],[3,"ngSwitch"],["class","prompt-text",4,"ngSwitchCase"],[4,"ngSwitchCase"],["class","media","alt","prompt",3,"src",4,"ngSwitchCase"],["class","prompt-text",4,"ngSwitchDefault"],[1,"options","ion-padding"],["class","option",3,"style","selected","correct","incorrect","click",4,"ngFor","ngForOf","ngForTrackBy"],[1,"footer","ion-padding"],["expand","block","shape","round",2,"height","56px",3,"click","disabled"],[1,"prompt-text"],[2,"max-height","200px","position","relative",3,"src"],["alt","prompt",1,"media",3,"src"],[1,"grid-video"],[4,"ngFor","ngForOf"],[1,"media-wrapper"],[3,"src"],[1,"option",3,"click"],[3,"src","alt",4,"ngSwitchCase"],["style","max-height: 200px;position: relative;",3,"src",4,"ngSwitchCase"],[1,"label"],[3,"src","alt"]],template:function(n,s){n&1&&(p(0,"ion-header",0)(1,"ion-toolbar")(2,"ion-buttons",1),g(3,"ion-back-button",2),c(),m(4,at,4,1,"ion-buttons",3),c(),p(5,"ion-toolbar")(6,"div",4)(7,"span"),d(8),c()(),p(9,"div",4)(10,"h4"),d(11),c()()()(),m(12,_t,13,9,"ion-content",5)),n&2&&(o(4),r("ngIf",(s.q==null?null:s.q.level)===(s.status==null?null:s.status.currentLevel)),o(4),v(s.q==null?null:s.q.group),o(3),v(s.q==null?null:s.q.name),o(),r("ngIf",s.q))},dependencies:[H,R,J,L,k,T,Q,E,B,j,V,N,$,A,K,Z],styles:[".card[_ngcontent-%COMP%]{background:#0b1220;color:#e5edff;box-shadow:0 8px 24px #0000002e}.prompt[_ngcontent-%COMP%]   .caption[_ngcontent-%COMP%]{font-size:16px;font-weight:700;margin-bottom:10px}.grid-video[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(4,1fr);gap:8px}.media-wrapper[_ngcontent-%COMP%]{position:relative}.media[_ngcontent-%COMP%]{width:100%;height:200px;background:#000}.prompt-text[_ngcontent-%COMP%]{font-size:16px;font-weight:600}.options[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr;gap:12px;margin-top:16px}.option[_ngcontent-%COMP%]{border:none;text-align:left;background:#111827;color:#fff;border-radius:16px;padding:12px;display:grid;grid-template-columns:88px 1fr;gap:10px;align-items:center;box-shadow:0 6px 14px #0003}.option[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .option[_ngcontent-%COMP%]   video[_ngcontent-%COMP%]{width:88px;height:64px;object-fit:cover;border-radius:10px;background:#000}.option[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{font-weight:700}.option.selected[_ngcontent-%COMP%]{outline:2px solid #60a5fa}.option.correct[_ngcontent-%COMP%]{background:#064e3b}.option.incorrect[_ngcontent-%COMP%]{background:#7f1d1d}.footer[_ngcontent-%COMP%]{margin-top:20px}app-video-player[_ngcontent-%COMP%]   video[_ngcontent-%COMP%]{height:100%!important;position:relative}"]});let t=a;return t})();export{Et as QuizGamePage};
